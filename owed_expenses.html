<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.6">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; -webkit-text-stroke: #000000}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; -webkit-text-stroke: #000000; min-height: 14.0px}
    span.s1 {font-kerning: none}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!&lt;!DOCTYPE html&gt;</span></p>
<p class="p1"><span class="s1">&lt;html lang="en"&gt;</span></p>
<p class="p1"><span class="s1">&lt;head&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;meta charset="UTF-8"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;title&gt;Owed Expenses Tracker&lt;/title&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;!-- Tailwind CSS CDN --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script src="https://cdn.tailwindcss.com"&gt;&lt;/script&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;style&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>body {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-family: "Inter", sans-serif;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: #f0f4f8;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>display: flex;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>justify-content: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>align-items: flex-start;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>min-height: 100vh;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>padding: 20px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>box-sizing: border-box;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.container {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: #ffffff;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border-radius: 12px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>padding: 30px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>width: 100%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>max-width: 900px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>display: flex;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>flex-direction: column;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>gap: 20px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.input-group label {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-weight: 600;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: #334155;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>margin-bottom: 8px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>display: block;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.input-group input {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>width: 100%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>padding: 12px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border: 1px solid #cbd5e1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border-radius: 8px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-size: 16px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>transition: border-color 0.2s;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.input-group input:focus {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>outline: none;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border-color: #6366f1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.btn {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>padding: 12px 20px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border-radius: 8px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-weight: 600;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>cursor: pointer;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>transition: background-color 0.2s, transform 0.1s;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.btn-primary {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: #6366f1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: white;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border: none;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.btn-primary:hover {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: #4f46e5;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>transform: translateY(-1px);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.btn-primary:active {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>transform: translateY(0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.btn-success {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: #22c55e;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: white;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border: none;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-size: 0.875rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>padding: 8px 12px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.btn-success:hover {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: #16a34a;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.btn-edit {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: #3b82f6;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: white;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border: none;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-size: 0.875rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>padding: 8px 12px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>margin-left: 8px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.btn-edit:hover {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: #2563eb;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.table-container {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>overflow-x: auto;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>table {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>width: 100%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border-collapse: collapse;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>margin-top: 15px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>th, td {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>padding: 12px 15px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>text-align: left;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border-bottom: 1px solid #e2e8f0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>th {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: #f8fafc;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: #475569;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-weight: 700;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>text-transform: uppercase;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-size: 0.875rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>tr:hover {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: #f1f5f9;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.total-owed {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-size: 1.25rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-weight: 700;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: #16a34a;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>text-align: right;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>padding-top: 15px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border-top: 1px solid #e2e8f0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.loading-indicator {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>text-align: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>padding: 20px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: #64748b;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.message-box, .edit-modal {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: #fff;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border-radius: 8px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>padding: 20px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>position: fixed;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>top: 50%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>left: 50%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>transform: translate(-50%, -50%);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>z-index: 1000;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>display: none; /* Hidden by default */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>flex-direction: column;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>align-items: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>gap: 15px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>max-width: 350px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>text-align: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.message-box p, .edit-modal h2 {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-size: 1.1rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: #334155;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.message-box button, .edit-modal .modal-buttons button {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: #6366f1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: white;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>padding: 10px 20px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border-radius: 8px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border: none;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>cursor: pointer;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>transition: background-color 0.2s;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.message-box button:hover, .edit-modal .modal-buttons button:hover {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: #4f46e5;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.status-pending {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: #ef4444; /* Red for pending */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-weight: 600;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.status-paid {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: #16a34a; /* Green for paid */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-weight: 600;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>/* Modal specific styles */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.modal-overlay {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>position: fixed;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>top: 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>left: 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>width: 100%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>height: 100%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: rgba(0, 0, 0, 0.5);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>z-index: 999;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>display: none;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>justify-content: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>align-items: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.edit-modal {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>max-width: 500px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>width: 90%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>padding: 30px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>display: flex;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>flex-direction: column;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>gap: 20px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.edit-modal .input-group {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>text-align: left;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>width: 100%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.edit-modal .modal-buttons {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>display: flex;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>justify-content: flex-end;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>gap: 10px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>width: 100%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>margin-top: 20px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.edit-modal .modal-buttons .btn-cancel {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: #6b7280;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.edit-modal .modal-buttons .btn-cancel:hover {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: #4b5563;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/style&gt;</span></p>
<p class="p1"><span class="s1">&lt;/head&gt;</span></p>
<p class="p1"><span class="s1">&lt;body&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div class="container"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;h1 class="text-3xl font-bold text-gray-800 text-center mb-6"&gt;Owed Expenses Tracker&lt;/h1&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div class="text-sm text-gray-600 mb-4 text-center"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>User ID: &lt;span id="userIdDisplay" class="font-mono text-gray-700"&gt;Loading...&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;form id="expenseForm" class="grid grid-cols-1 md:grid-cols-4 gap-4 items-end"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="input-group"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;label for="description"&gt;Expense Description&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;input type="text" id="description" placeholder="e.g., Dinner with John" required class="rounded-md"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="input-group"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;label for="propertyAddress"&gt;Property Address&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;input type="text" id="propertyAddress" placeholder="e.g., 123 Main St" class="rounded-md"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="input-group"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;label for="amount"&gt;Amount Owed ($)&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;input type="number" id="amount" placeholder="e.g., 25.50" step="0.01" min="0" required class="rounded-md"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;button type="submit" class="btn btn-primary rounded-md"&gt;Add Expense&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/form&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div class="table-container"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;h2 class="text-2xl font-bold text-gray-800 mb-4"&gt;Your Owed Expenses&lt;/h2&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div id="loadingIndicator" class="loading-indicator"&gt;Loading expenses...&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;table id="expensesTable" class="hidden"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;thead&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;th&gt;Description&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;th&gt;Property Address&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;th&gt;Amount&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;th&gt;Date Added&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;th&gt;Status&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;th&gt;Action&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/thead&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;tbody id="expensesTableBody"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;!-- Expenses will be loaded here --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/tbody&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/table&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div id="noExpensesMessage" class="text-center text-gray-500 mt-4 hidden"&gt;No expenses to display yet. Add one above!&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div id="totalOwed" class="total-owed"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>Total Owed (Pending): $0.00</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;!-- Message Box for alerts --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div id="messageBox" class="message-box"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;p id="messageText"&gt;&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;button id="messageBoxOkBtn"&gt;OK&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;!-- Edit Expense Modal --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div id="editModalOverlay" class="modal-overlay"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div id="editModal" class="edit-modal"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;h2 class="text-2xl font-bold text-gray-800 mb-4"&gt;Edit Expense&lt;/h2&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;input type="hidden" id="editExpenseId"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="input-group"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;label for="editDescription"&gt;Expense Description&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;input type="text" id="editDescription" class="rounded-md"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="input-group"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;label for="editPropertyAddress"&gt;Property Address&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;input type="text" id="editPropertyAddress" class="rounded-md"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="input-group"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;label for="editAmount"&gt;Amount Owed ($)&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;input type="number" id="editAmount" step="0.01" min="0" class="rounded-md"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="modal-buttons"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;button id="cancelEditBtn" class="btn btn-cancel rounded-md"&gt;Cancel&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;button id="saveEditBtn" class="btn btn-primary rounded-md"&gt;Save Changes&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script type="module"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Firebase SDK imports</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>import { getFirestore, collection, addDoc, onSnapshot, updateDoc, doc, query } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Declare appId globally so it's accessible throughout the script</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const appId = "expenses-96372";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// DOM elements</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const expenseForm = document.getElementById('expenseForm');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const descriptionInput = document.getElementById('description');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const propertyAddressInput = document.getElementById('propertyAddress');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const amountInput = document.getElementById('amount');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const expensesTableBody = document.getElementById('expensesTableBody');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const totalOwedDisplay = document.getElementById('totalOwed');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const loadingIndicator = document.getElementById('loadingIndicator');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const expensesTable = document.getElementById('expensesTable');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const noExpensesMessage = document.getElementById('noExpensesMessage');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const userIdDisplay = document.getElementById('userIdDisplay');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const messageBox = document.getElementById('messageBox');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const messageText = document.getElementById('messageText');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const messageBoxOkBtn = document.getElementById('messageBoxOkBtn');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Edit Modal DOM elements</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const editModalOverlay = document.getElementById('editModalOverlay');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const editExpenseIdInput = document.getElementById('editExpenseId');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const editDescriptionInput = document.getElementById('editDescription');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const editPropertyAddressInput = document.getElementById('editPropertyAddress');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const editAmountInput = document.getElementById('editAmount');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const saveEditBtn = document.getElementById('saveEditBtn');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const cancelEditBtn = document.getElementById('cancelEditBtn');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>let db;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>let auth;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>let currentUserId = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>let isAuthReady = false; // Flag to ensure auth is ready before Firestore operations</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>let currentExpenses = []; // Store expenses for easy access during editing</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Show custom message box</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function showMessageBox(message) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>messageText.textContent = message;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>messageBox.style.display = 'flex';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Hide custom message box</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>messageBoxOkBtn.addEventListener('click', () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>messageBox.style.display = 'none';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Show edit modal</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function showEditModal() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>editModalOverlay.style.display = 'flex';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Hide edit modal</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function hideEditModal() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>editModalOverlay.style.display = 'none';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Initialize Firebase</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Your Firebase config. This looks correct based on what you provided,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// assuming these are the actual values from your Firebase project.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const firebaseConfig = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>apiKey: "AIzaSyCSGurEkKVf3zyITVVejQiNvPX6DBQD0sU",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>authDomain: "expenses-96372.firebaseapp.com",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>projectId: "expenses-96372",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>storageBucket: "expenses-96372.firebasestorage.app",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>messagingSenderId: "815816657733",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>appId: "1:815816657733:web:5aae3f3f4a748fb6034c2c",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>measurementId: "G-650F33V922"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// This check is good to keep in case you ever use placeholder values again</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (firebaseConfig.apiKey === "YOUR_API_KEY" || firebaseConfig.authDomain === "YOUR_PROJECT_ID.firebaseapp.com") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>showMessageBox("Firebase configuration is incomplete. Please ensure all placeholder values in the script are replaced with your actual Firebase project credentials.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>console.error("Firebase configuration is incomplete. Please update firebaseConfig with your actual values.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const app = initializeApp(firebaseConfig);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>db = getFirestore(app);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>auth = getAuth(app);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Authenticate user</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>onAuthStateChanged(auth, async (user) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (user) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>currentUserId = user.uid;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>userIdDisplay.textContent = currentUserId;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>isAuthReady = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>console.log("User signed in:", currentUserId);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>// Once authenticated, start listening for expenses</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>listenForExpenses();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>// Sign in anonymously if no user is present</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>await signInAnonymously(auth);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>} catch (error) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>console.error("Error signing in anonymously:", error);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>showMessageBox("Error signing in. Please try again later.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>userIdDisplay.textContent = "Authentication failed.";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>} catch (error) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>console.error("Failed to initialize Firebase:", error);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>showMessageBox("Failed to initialize the application. Please check the console for details.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Function to listen for real-time updates to expenses</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function listenForExpenses() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!isAuthReady || !currentUserId) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>console.log("Authentication not ready or user ID not available. Cannot listen for expenses.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Use the globally defined 'appId' variable</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const expensesCollectionRef = collection(db, `artifacts/${appId}/users/${currentUserId}/expenses`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const q = query(expensesCollectionRef);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>onSnapshot(q, (snapshot) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>let totalPending = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>expensesTableBody.innerHTML = ''; // Clear existing table rows</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>currentExpenses = []; // Clear and repopulate currentExpenses</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>snapshot.forEach((doc) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const expense = doc.data();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>currentExpenses.push({ id: doc.id, ...expense });</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Sort expenses by timestamp in descending order (newest first)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>currentExpenses.sort((a, b) =&gt; b.timestamp - a.timestamp);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (currentExpenses.length === 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>expensesTable.classList.add('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>noExpensesMessage.classList.remove('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>expensesTable.classList.remove('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>noExpensesMessage.classList.add('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>currentExpenses.forEach((expense) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>// Only sum if status is 'Pending'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>if (expense.status === 'Pending') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>totalPending += expense.amount;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>const row = expensesTableBody.insertRow();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>const statusClass = expense.status === 'Pending' ? 'status-pending' : 'status-paid';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>const actionButtons = expense.status === 'Pending'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>? `&lt;button class="btn btn-success mark-paid-btn rounded-md" data-id="${expense.id}"&gt;Mark Paid&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                               </span>&lt;button class="btn btn-edit edit-expense-btn rounded-md" data-id="${expense.id}"&gt;Edit&lt;/button&gt;`</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>: `&lt;span class="${statusClass}"&gt;Paid&lt;/span&gt;`;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>row.innerHTML = `</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td&gt;${expense.description}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td&gt;${expense.propertyAddress || 'N/A'}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td&gt;$${expense.amount.toFixed(2)}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td&gt;${new Date(expense.timestamp).toLocaleDateString()}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td class="${statusClass}"&gt;${expense.status}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td&gt;${actionButtons}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>totalOwedDisplay.textContent = `Total Owed (Pending): $${totalPending.toFixed(2)}`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>loadingIndicator.classList.add('hidden'); // Hide loading after data is displayed</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}, (error) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>console.error("Error fetching expenses:", error);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>showMessageBox("Error loading expenses. Please try refreshing the page.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>loadingIndicator.classList.add('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Add Expense</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>expenseForm.addEventListener('submit', async (e) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>e.preventDefault();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!isAuthReady || !currentUserId) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>showMessageBox("Please wait, application is still authenticating...");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const description = descriptionInput.value.trim();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const propertyAddress = propertyAddressInput.value.trim();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const amount = parseFloat(amountInput.value);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!description || isNaN(amount) || amount &lt;= 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>showMessageBox("Please enter a valid description and a positive amount.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Use the globally defined 'appId' variable</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>await addDoc(collection(db, `artifacts/${appId}/users/${currentUserId}/expenses`), {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>description: description,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>propertyAddress: propertyAddress,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>amount: amount,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>timestamp: Date.now(), // Store timestamp for sorting</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>status: 'Pending', // Initial status</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>userId: currentUserId</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>descriptionInput.value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>propertyAddressInput.value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>amountInput.value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>descriptionInput.focus();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>console.error("Error adding document: ", e);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>showMessageBox("Failed to add expense. Please try again.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Event listener for table body to handle both "Mark Paid" and "Edit" buttons</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>expensesTableBody.addEventListener('click', async (e) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Mark Expense as Paid (Update Status)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (e.target.classList.contains('mark-paid-btn')) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const expenseId = e.target.dataset.id;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (!expenseId) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>showMessageBox("Could not find expense ID to update.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (!isAuthReady || !currentUserId) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>showMessageBox("Please wait, application is still authenticating...");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// Use the globally defined 'appId' variable</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>await updateDoc(doc(db, `artifacts/${appId}/users/${currentUserId}/expenses`, expenseId), {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>status: 'Paid'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>console.error("Error updating document: ", e);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>showMessageBox("Failed to mark expense as paid. Please try again.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Edit Expense</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (e.target.classList.contains('edit-expense-btn')) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const expenseId = e.target.dataset.id;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const expenseToEdit = currentExpenses.find(exp =&gt; exp.id === expenseId);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (expenseToEdit) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>editExpenseIdInput.value = expenseToEdit.id;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>editDescriptionInput.value = expenseToEdit.description;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>editPropertyAddressInput.value = expenseToEdit.propertyAddress || '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>editAmountInput.value = expenseToEdit.amount;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>showEditModal();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>showMessageBox("Expense not found for editing.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Save Changes in Edit Modal</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>saveEditBtn.addEventListener('click', async () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const expenseId = editExpenseIdInput.value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const updatedDescription = editDescriptionInput.value.trim();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const updatedPropertyAddress = editPropertyAddressInput.value.trim();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const updatedAmount = parseFloat(editAmountInput.value);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!updatedDescription || isNaN(updatedAmount) || updatedAmount &lt;= 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>showMessageBox("Please enter a valid description and a positive amount for the edited expense.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!isAuthReady || !currentUserId) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>showMessageBox("Please wait, application is still authenticating...");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Use the globally defined 'appId' variable</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>await updateDoc(doc(db, `artifacts/${appId}/users/${currentUserId}/expenses`, expenseId), {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>description: updatedDescription,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>propertyAddress: updatedPropertyAddress,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>amount: updatedAmount</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>hideEditModal();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>console.error("Error updating expense:", e);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>showMessageBox("Failed to save changes. Please try again.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Cancel Edit Modal</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>cancelEditBtn.addEventListener('click', () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>hideEditModal();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Initial call to hide loading and show message if no expenses (before snapshot loads)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>loadingIndicator.classList.remove('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>expensesTable.classList.add('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>noExpensesMessage.classList.add('hidden');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</span></p>
<p class="p1"><span class="s1">&lt;/body&gt;</span></p>
<p class="p1"><span class="s1">&lt;/html&gt;</span></p>
</body>
</html>
